<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8" />
    <title>WD!!</title>
    <link rel="icon" href="/favicon.png" type="image/png" />
        <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HB78MEGS2W"></script>
    <meta name="description" content="わためと自由研究2025!" />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap"
      rel="stylesheet"
    />

    <!-- リセットCSS -->
    <link rel="stylesheet" href="https://unpkg.com/ress/dist/ress.min.css" />

    <!-- 自作CSS -->
    <link rel="stylesheet" href="/css/style.css" />

    <style>
      #scoreTitle {
        font-size: 2.5rem;
        margin-bottom: 1rem;
        color: white;
        font-weight: bold;
        text-align: center;
      }

      #finalScore {
        font-size: 4rem;
        color: white;
        text-align: center;
        margin-bottom: 2rem;
      }

      #resultButtons button {
        font-size: 1.2rem;
        padding: 0.5rem 1rem;
        cursor: pointer;
        border-radius: 6px;
        border: none;
        background-color: #1DA1F2;
        color: white;
        transition: background-color 0.3s ease;
      }

      #resultButtons button:hover {
        background-color: #0d8ddb;
      }

      /* Hide lanes during result */
      #lanes.result-hidden {
        display: none;
      }
    </style>
</head>
<body>
  <header>
    <h1>wsn0672の作品 #わためと自由研究2025</h1>
  </header>

  <main>
    <p>わためと自由研究2025!ってことて<br>わためぇソングを収録した音ゲーを作ってみました<br></p>
    <section>
      <h2>このゲームについて</h2>
      <p>
        わためぇの曲を収録したPC向け音ゲーです<br>
        譜面は手打ちなのでズレてるかもしれません。許して<br>
      </p>
    </section>
    <section>
      <h2>あそびかた</h2>
      <p>
        D,F,J,Kキーで操作します<br>
        ノーツの色によって効果があります<br>
        <h3>【水色ノーツ】</h3>
          普通のノーツ。最大で1000ポイント獲得できます<br>
        <h3>【紫色ノーツ】</h3>
          右や左のレーンに突然ずれることがあります。得点は水色と一緒です<br>
        <h3>【橙色ノーツ】</h3>
        獲得できるポイントが2倍です。<br>
      </p>
    </section>
<br>
    <button onclick="location.href='/select.html'">▶ ゲームをはじめる</button>
    <section>
      <h2>作者について</h2>
      <p>
        作者(<a href="https://x.com/wsn0672">wsn0672</a>)は東京都に住む中学2年生<br>
        小6のときにわためいとになったらしい
      </p>
    </section><br>
    <p>バグとかあったら<a href="https://docs.google.com/forms/d/e/1FAIpQLSdID9_vDyH1WsCCQ72nE5ol20sshnQJJcGK2rWcqqu4oZ2J9Q/viewform?usp=header">フォームから</a>報告ください</p>
</main>

<button id="copyUaBtn" style="font-size: 0.8rem; position: fixed; bottom: 10px; right: 10px;">
  UAをコピー (報告用)
</button>

<div id="resultOverlay">
  <div id="scoreTitle">Score</div>
  <div id="finalScore">0</div>
  <div id="resultButtons" style="display:none;">
    <button id="shareXBtn">Xでシェアする</button>
  </div>
</div>

<script>
  let score = 0;
  const scoreDisplay = document.getElementById('finalScore');

  function updateScore(newScore) {
    score = newScore;
    console.log("Score:", score);
    if(scoreDisplay) scoreDisplay.textContent = score;
  }

  const uaButton = document.getElementById('copyUaBtn');
  uaButton.addEventListener('click', () => {
    navigator.clipboard.writeText(navigator.userAgent)
      .then(() => {
        uaButton.textContent = "コピーしました";
        setTimeout(() => {
          uaButton.textContent = "UAをコピー (報告用)";
        }, 2000);
      });
  });

  const scoreTitle = document.getElementById('scoreTitle');
  const resultButtons = document.getElementById('resultButtons');
  const shareXBtn = document.getElementById('shareXBtn');
  const lanesContainer = document.getElementById('lanes');

  function showResult() {
    // Hide lanes
    lanesContainer.classList.add('result-hidden');

    resultOverlay.style.display = 'flex';
    setTimeout(() => resultOverlay.classList.add('show'), 10);

    // Animate score count up
    let displayedScore = 0;
    const increment = Math.max(1, Math.floor(score / 100));
    const interval = setInterval(() => {
      displayedScore += increment;
      if (displayedScore >= score) {
        displayedScore = score;
        clearInterval(interval);
        // Show buttons after score animation ends
        resultButtons.style.display = 'block';
      }
      finalScore.textContent = displayedScore.toLocaleString();
    }, 20);

    bgVideo.pause();
  }

  shareXBtn.addEventListener('click', () => {
    const tweetText = encodeURIComponent(`このゲームで${score.toLocaleString()}点とったよ！みんなもやってみて！\nhttps://わためぇ自由研究.wsn0672.org`);
    const url = `https://twitter.com/intent/tweet?text=${tweetText}`;
    window.open(url, '_blank');
  });
</script></body>
</html>